Hello Everyone, 


In this project, I will explain in a step-by-step guide how to deploy the Wazuh SEIM and enable vulnerability detection. A Wazuh agent will be installed on an Ubuntu Linux virtual machine. We will enable vulnerability detection on the Ubuntu computer to connect with the Wazuh SEIM and analyze the vulnerabilities from the Wazuh SEIM manager. 


Vulnerability Detection 


Vulnerabilities and threats are a constant issue accross the internet and organizations. Understanding these risks and how to mitigate them can prevent security breaches and attacks. The Wazuh SEIM allows you to install an agent on your computers to detect real time vulnerabilities. 


Step 1. Download and Obtain Platform and Tools 

VirtualBox ➡️https://www.virtualbox.org/wiki/Downloads 

Ubuntu 22.04.4 ISO File ➡️https://ubuntu.com/download/desktop 

Wazuh OVA File ➡️ For this lab we will be using the Wazuh OVA File click the hyperlink that says “virtual appliance (OVA) and it will download the file (https://documentation.wazuh.com/current/deployment-options/virtual-machine/virtual-machine.html ) 


Step 2. Import OVA File and Ubuntu File Into VirtualBox 

 
When you open VirtualBox, go to the top left and click file 

Then click Import Appliance 

 
Click the folder icon on the right side and locate the Wazuh OVA file 

Click Wazuh OVA file 


You should see the Wazuh OVA in the VirtualBox Manager 


To create an Ubuntu virtual machine click the new button at the top of VirtualBox Manager 

Locate your Ubuntu iso file 

Configure the Ubuntu virtual machine to have 4 GB of Ram and 2 core processors 


Step 3. Run Wazuh OVA and Obtain IP Address 

Doubled click the Wazuh OVA to run Wazuh computer 

 

Then you will see Wazuh login show up on the screen 

Login with these credentials 

	Wazuh username: wazuh-user 

	Password: wazuh 


Once the command line shows up, type ifconfig to get your IP address 

Copy and save that IP for the next step 

 

Step 4. Access Wazuh Dashboard Through Web Portal 

On your web browser type in https://<Your Wazuh IP Address> and hit enter 

Type in these credentials to log into your Wazuh Dashboard 

	Username: admin 

	Password: admin 

 

Wazuh Manager 

 

Welcome To The Wazuh Dashboard Manager! 

 

The Wazuh SEIM allows you to install an agent on your computers to detect real time vulnerabilities. The information will then be sent back to the Wazuh manager. You can view the vulnerabilities for each computer on the Wazuh Dashboard. 

 

 

Step 5. Add Ubuntu Linux Virtual Machine To Wazuh 

 

Adding the Wazuh agent to the Ubuntu virtual machine will synchronize with the Wazuh dashboard. This will allow events to show up for analysis on the Wazuh dashboard manager from your Ubuntu virtual computer. 

 

Click the button that says “Add agent” 

 

Since we are adding Ubuntu to the Wazuh dashboard, select Linux  

Click “DEB amd64” 



For server address copy your Wazuh server IP address in your web browser URL and use that 

 

Once you have the Ubuntu virtual machine running, right click on the Ubuntu screen and click “Open In Terminal” 

 

Once you have the terminal open go back to the Wazuh dashboard and copy the code that we need to paste into the Ubuntu computer terminal 



Paste code in Ubuntu terminal command line 

If you can’t paste it make sure to go to the Device tab on the top scroll down to “Shared Clipboard” and click “Bidirectional” 

Also, if you can’t get the file to work because of a “username not in the sudo file” issue in the terminal then switch to root user by pressing “su” and then type in your password. After that you should be able to run the code 

Then start the agent by copying and pasting this code in the Ubuntu command line 

 

Now go to the top arrow on the Wazuh dashboard 


Click arrow and click “Agents” 



You will see at the bottom your Ubuntu virtual machine that you connected through the command line 

You will now be able to see different events that will be sent to the dashboard for analysis 



Step 6. Enabling Vulnerability Detection 


Vulnerability detection is disabled by default. We need to enable it on the Wazuh manager and the Ubuntu virtual machine. 


First in the Wazuh dashboard, click the arrow at the top left 

Click “Management” 

Then click “Configuration” 


Next, on the right side of the screen click “Edit configuration” 

 

This is the Wazuh manager ossec.conf file editor page 

 

Scroll down to the “Vulnerability detector section” and turn <enabled>no</enabled> to yes (delete no and type “yes”) 

Scroll down to “Debian OS Vulnerabilities” and enable it by changing it from no to “yes” 

Scroll down to “Ubuntu OS Vulnerabilities” and enable it by changing it from no to “yes” 

Scroll down to “Sys Collector” and enable it by changing it from no to “yes” 



Click save button at the top right to save changes 



Then click “Restart manager” to restart it so the changes are permanent 



Next, go to your Ubuntu virtual machine 

Click the desktop folder and open the “wazuh-agent_4.7.3-1_amd64.deb” file 

Right click the “data.tar.gz” file 

Then right click the “.” folder and click extract 

Click the “ossec” folder 


Click the “etc” folder and then right click the “ossec.conf” file 

Open with the application “Text editor” 

Go down to “Sys Collector” and enable it to yes 



Click save at the top right to save configuration changes 


In the Ubuntu terminal 

Restart the Wazuh agent by running this command “sudo systemctl restart wazuh-agent" 

Remember if that “username is not in the sudoers file” issue appears switch to root user and then run the command 


Step 7. Verify Vulnerability Detection Is Enabled 


Go to the arrow on the top left 

Click Modules 

Click Vulnerabilities under “Threat Detection and Response” 

 
The vulnerabilities should now show up in the list for the Ubuntu virtual machine 

There are two main things to help you understand vulnerabilities 

CVE (Common Vulnerabilities and Exposures): This number allows you to look the vulnerability up in a known vulnerability list. This will allow you to learn more about the vulnerability and how to mitigate it. 

CVSS (Common Vulnerability Scoring System): This score rates the vulnerability on its severity 







Click a vulnerability and you can see more details about it 


I hope this project helped you create your own Wazuh SEIM and analyze vulnerabilities. The goal is to catch them before they get exploited by an attacker. 

Let me know if you have any questions! 
